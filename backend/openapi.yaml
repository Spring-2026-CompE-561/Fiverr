openapi: 3.0.3
info:
 title: Giglink Marketplace API
 version: 1.0.0
 description: >
   A scoped-down Fiverr-like marketplace without payments.
   Users register as buyers or sellers. Sellers create gigs. Buyers place orders/requests.
   Sellers accept/reject/complete orders. Buyers can leave reviews.


servers:
 - url: http://localhost:8000


tags:
 - name: Auth
 - name: Users
 - name: Gigs
 - name: Orders
 - name: Reviews


paths:
 # ---------------------------
 # AUTH
 # ---------------------------
 /api/auth/register:
   post:
     tags: [Auth]
     summary: Register a new user (buyer or seller)
     requestBody:
       required: true
       content:
         application/json:
           schema:
             $ref: "#/components/schemas/RegisterRequest"
     responses:
       "201":
         description: User registered successfully
         content:
           application/json:
             schema:
               $ref: "#/components/schemas/AuthResponse"
       "400":
         description: Validation error or duplicate email
         content:
           application/json:
             schema:
               $ref: "#/components/schemas/ErrorResponse"


 /api/auth/login:
   post:
     tags: [Auth]
     summary: Login and receive JWT token
     requestBody:
       required: true
       content:
         application/json:
           schema:
             $ref: "#/components/schemas/LoginRequest"
     responses:
       "200":
         description: Logged in successfully
         content:
           application/json:
             schema:
               $ref: "#/components/schemas/AuthResponse"
       "401":
         description: Invalid credentials
         content:
           application/json:
             schema:
               $ref: "#/components/schemas/ErrorResponse"


   # ---------------------------
   # ENUMS
   # ---------------------------
   UserRole:
     type: string
     enum: [buyer, seller]


   OrderStatus:
     type: string
     enum: [pending, accepted, rejected, completed]


   # ---------------------------
   # AUTH SCHEMAS
   # ---------------------------
   RegisterRequest:
     type: object
     required: [name, email, password, role]
     properties:
       name: { type: string, minLength: 1 }
       email: { type: string, format: email }
       password: { type: string, minLength: 6 }
       role:
         $ref: "#/components/schemas/UserRole"


   LoginRequest:
     type: object
     required: [email, password]
     properties:
       email: { type: string, format: email }
       password: { type: string }


   AuthResponse:
     type: object
     properties:
       success: { type: boolean, example: true }
       token: { type: string, example: "jwt.token.here" }
       user:
         $ref: "#/components/schemas/UserPublic"
# ---------------------------
 # USERS
 # ---------------------------
 /api/users/{id}:
   get:
     tags: [Users]
     summary: Get a user profile by id
     parameters:
       - name: id
         in: path
         required: true
         schema: { type: string }
     responses:
       "200":
         description: User profile
         content:
           application/json:
             schema:
               $ref: "#/components/schemas/UserPublic"
       "404":
         description: User not found
         content:
           application/json:
             schema:
               $ref: "#/components/schemas/ErrorResponse"


   put:
     tags: [Users]
     summary: Update user profile (must be the same user)
     security:
       - bearerAuth: []
     parameters:
       - name: id
         in: path
         required: true
         schema: { type: string }
     requestBody:
       required: true
       content:
         application/json:
           schema:
             $ref: "#/components/schemas/UserUpdate"
     responses:
       "200":
         description: Updated user profile
         content:
           application/json:
             schema:
               $ref: "#/components/schemas/SuccessUserResponse"
       "401":
         description: Not authenticated
         content:
           application/json:
             schema:
               $ref: "#/components/schemas/ErrorResponse"
       "403":
         description: Forbidden (updating another user)
         content:
           application/json:
             schema:
               $ref: "#/components/schemas/ErrorResponse"
       "404":
         description: User not found
         content:
           application/json:
             schema:
               $ref: "#/components/schemas/ErrorResponse"


   delete:
     tags: [Users]
     summary: Delete user account (must be the same user)
     security:
       - bearerAuth: []
     parameters:
       - name: id
         in: path
         required: true
         schema: { type: string }
     responses:
       "200":
         description: User deleted
         content:
           application/json:
             schema:
               $ref: "#/components/schemas/SuccessResponse"
       "401":
         description: Not authenticated
         content:
           application/json:
             schema:
               $ref: "#/components/schemas/ErrorResponse"
       "403":
         description: Forbidden (deleting another user)
         content:
           application/json:
             schema:
               $ref: "#/components/schemas/ErrorResponse"


   # ---------------------------
   # USER SCHEMAS
   # ---------------------------
   UserPublic:
     type: object
     properties:
       id: { type: string, example: "b3d1c3a2-..." }
       name: { type: string }
       email: { type: string, format: email }
       role:
         $ref: "#/components/schemas/UserRole"
       bio: { type: string, nullable: true }
       created_at: { type: string, format: date-time }
       updated_at: { type: string, format: date-time }


   UserUpdate:
     type: object
     properties:
       name: { type: string }
       email: { type: string, format: email }
       bio: { type: string }


   SuccessUserResponse:
     type: object
     properties:
       success: { type: boolean, example: true }
       user:
         $ref: "#/components/schemas/UserPublic"


